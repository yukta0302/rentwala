<%- include('partials/header') %>

<section style="padding: 50px; font-family: 'Segoe UI', sans-serif; background-color: #f9f9f9;">
  <div style="max-width: 1100px; margin: auto; background: #fff; border-radius: 16px; padding: 40px; display: flex; gap: 40px; box-shadow: 0 10px 25px rgba(0,0,0,0.08); flex-wrap: wrap;">

    <!-- üì∏ Product Image -->
    <div style="flex: 1 1 350px;">
      <img src="<%= product.imageUrl %>" alt="<%= product.name %>" style="width: 100%; border-radius: 12px; object-fit: cover;">
    </div>

    <!-- üìù Product Info + Form -->
    <div style="flex: 1 1 350px;">
      <h2 style="margin-bottom: 8px; color: #222;"><%= product.name %></h2>
      <p style="color: #777; font-size: 14px; margin-bottom: 12px;"><strong>Category:</strong> <%= product.category %></p>

      <p style="line-height: 1.6; color: #555; font-size: 15px; margin-bottom: 20px;"><%= product.description %></p>

      <p style="margin-bottom: 8px;"><strong>Price/Day:</strong> ‚Çπ<%= product.amount %></p>
      <p><strong>Available Stock:</strong> <%= product.quantity %></p>

      <!-- üßæ Rental Form -->
      <form action="/cart/add" method="POST" style="margin-top: 25px;">
        <input type="hidden" name="productId" value="<%= product._id %>">

        <div style="margin-bottom: 16px;">
          <label for="daysInput" style="font-weight: 500;">Rental Duration (Days):</label><br>
          <input type="number" id="daysInput" name="days" min="1" value="1" required 
                 style="margin-top: 6px; padding: 10px; width: 120px; border-radius: 6px; border: 1px solid #ccc;">
        </div>

        <div style="margin-bottom: 20px;">
          <label for="quantityInput" style="font-weight: 500;">Quantity:</label><br>
          <input type="number" id="quantityInput" name="quantity" min="1" max="<%= product.quantity %>" value="1" required 
                 style="margin-top: 6px; padding: 10px; width: 120px; border-radius: 6px; border: 1px solid #ccc;">
        </div>

        <div style="padding: 20px; background: #f3f3f3; border-radius: 10px; margin-bottom: 25px;">
          <h4 style="margin-bottom: 12px;"> Cost Summary:</h4>
          <p style="margin: 4px 0;">Price per day: ‚Çπ<span id="pricePerDay"><%= product.amount %></span></p>
          <p style="margin: 4px 0;">Days: <span id="daysSelected">1</span></p>
          <p style="margin: 4px 0;">Quantity: <span id="quantitySelected">1</span></p>
          <h3 style="margin-top: 15px; color: #111;">‚û°Ô∏è Total: <span id="totalAmount">‚Çπ<%= product.amount %></span></h3>
        </div>

        <button type="submit" 
                style="padding: 14px 28px; background-color: #4b4bff; color: white; font-weight: 600; border: none; border-radius: 8px; cursor: pointer; font-size: 16px; transition: background 0.3s;">
          Add to Cart
        </button>
      </form>
    </div>
  </div>
</section>

<!-- ‚úÖ Live Price Update Script -->
<script>
  const daysInput = document.getElementById('daysInput');
  const quantityInput = document.getElementById('quantityInput');
  const pricePerDay = <%= product.amount %>;

  const daysSelected = document.getElementById('daysSelected');
  const quantitySelected = document.getElementById('quantitySelected');
  const totalAmount = document.getElementById('totalAmount');

  function updateTotal() {
    const days = parseInt(daysInput.value) || 1;
    const qty = parseInt(quantityInput.value) || 1;
    daysSelected.textContent = days;
    quantitySelected.textContent = qty;
    const total = days * qty * pricePerDay;
    totalAmount.textContent = `‚Çπ${total}`;
  }

  daysInput.addEventListener('input', updateTotal);
  quantityInput.addEventListener('input', updateTotal);

  updateTotal(); // Initialize
</script>

<%- include('partials/footer') %>
